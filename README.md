# Ensemble
이 레포지터리에서 설명하는 내용은 파이썬 머신러닝 완벽 가이드 책에 나오는 내용을 정리한 것임<br>
개인적으로 파이썬 머신러닝 완벽가이드를 사서 읽어보는 것을 추천함
### Ensemble이란?
앙상블 학습을 통한 분류는 여러 개의 분류기를 생성하고 그 예측을 결합함으로써 보다 정확한 최종 예측을 도출하는 기법을 말한다.
### 앙상블의 유형
앙상블의 유형에는 보팅(Voting), 배깅(Bagging), 부스팅(Boosting), 스태킹(Stacking)을 포함한 다양한 앙상블 방법이 있다.
### 보팅(Voting)
<img src="https://cdn.discordapp.com/attachments/701041011174015006/701123105283768390/unknown.png" title="Voting" alt="Voting" width="50%"></img><br>
위의 그림은 보팅을 도식화 한 것이다. 보팅은 일반적으로 위의 그림에서 예시를 든 LR, kNN, SVM과 같은 서로 다른 알고리즘이 같은 데이터 세트에 대해 학습하고 예측한 결과를 가지고 보팅을 통해 최종 예측 결과를 선정하는 방법이다.
### 배깅(Bagging)
<img src="https://cdn.discordapp.com/attachments/701041011174015006/701127163759558696/unknown.png" title="Bagging" alt="Bagging" width="50%"></img><br>
위의 그림은 배깅을 도식화 한 것이다. 배깅은 부트스트래핑 분할 방식으로 샘플링된 데이터 세트를 여러개의 단일 ML 알고리즘(결정 트리 등)으로 개별 예측한 결과를 보팅을 통해서 최종 예측 결과를 선정하는 방법이다. 여기서 부트스트래핑(Bootstrapping) 분할 방식이란 개별 분류기에게 원본 학습 데이터에서 데이터를 샘플링해서 추출하는 방식을 말한다. 데이터를 샘플링할 때에는 데이터가 중첩되는 것을 허용하기 때문에 10000개의 데이터를 10개의 분류기가 나누더라도 각 1000개의 데이터 내에 중복된 데이터가 있을 수 있다. 대표적인 알고리즘으로 랜덤 포레스트가 있다.
### 보팅 유형
위에 설명한 보팅과 배깅은 보팅을 통해 최종 예측 결과를 선정한다고 했다. 이 보팅 방법에는 두 가지가 있는데 바로 하드 보팅과 소프트 보팅이다.
#### 하드 보팅(Hard Voting)
<img src="" title="Hard Voting" alt="Hard Voting"></img><br>
하드 보팅을 이용한 분류는 다수결 원칙과 비슷하다. 예측한 결괏값들 중 다수의 분류기가 결정한 예측값을 최종 보팅 결괏값으로 선정하는 것이다.
#### 소프트 보팅(Soft Voting)
<img src="" title="Soft Voting" alt="Soft Voting"></img><br>
소프트 보팅은 분류기들의 레이블 값 결정 확률을 모두 더하고 이를 평균해서 이들 중 확률이 가장 높은 레이블 값을 최종 보팅 결괏값으로 선정한다. 일반적으로 하드 보팅보다 소프트 보팅이 예측 성능이 좋아서 더 많이 사용한다.
### 부스팅(Boosting)
<img src="https://cdn.discordapp.com/attachments/701041011174015006/701138056308326441/unknown.png" title="AdaBoosting" alt="AdaBoosting"></img><br>
위의 그림은 부스팅 알고리즘 중 하나인 AdaBoost를 학습하는 과정을 도식화 한 것이다. 위의 그림을 볼 때, 동그라미가 처진 것은 잘못 분류된 것이고 기호의 크기는 가중치와 비례해서 보면 된다. 부스팅은 여러 개의 분류기가 순차적으로 학습을 수행하되, 앞에서 학습한 분류기가 예측이 틀린 데이터에 대해서는 올바르게 예측할 수 있도록 다음 분류기에게 는 가중치(weight)를 부여하면서 학습과 예측을 진행하는 것이다. 예측 성능이 뛰어나 앙상블 학습을 주도하고 있으며 대표적인 부스팅 알고리즘으로 그래디언트 부스트, XGBoost, LightGBM이 있다.
### 스태킹(Stacking)
